<!DOCTYPE html>
<html lang="en">
<head prefix="og: http://ogp.me/ns#">
  <meta charset="utf-8">
  <title>文档</title>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- Canonical links -->
  <link rel="canonical" href="https://hexo.io/docs/modules_crud.html">
  <!-- Alternative links -->
  
    
      <link rel="alternative" hreflang="en" href="https://hexo.io/docs/modules_crud.html">
    
      <link rel="alternative" hreflang="zh-tw" href="https://hexo.io/zh-tw/docs/modules_crud.html">
    
      <link rel="alternative" hreflang="zh-cn" href="https://hexo.io/zh-cn/docs/modules_crud.html">
    
      <link rel="alternative" hreflang="ru" href="https://hexo.io/ru/docs/modules_crud.html">
    
      <link rel="alternative" hreflang="ko" href="https://hexo.io/ko/docs/modules_crud.html">
    
      <link rel="alternative" hreflang="pt-br" href="https://hexo.io/pt-br/docs/modules_crud.html">
    
  
  <!-- Icon -->
  <link rel="apple-touch-icon" sizes="57x57" href="/icon/apple-touch-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icon/apple-touch-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icon/apple-touch-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icon/apple-touch-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icon/apple-touch-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icon/apple-touch-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icon/apple-touch-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icon/apple-touch-icon-152x152.png">
  <link rel="icon" type="image/png" href="/icon/favicon-196x196.png" sizes="196x196">
  <link rel="icon" type="image/png" href="/icon/favicon-160x160.png" sizes="160x160">
  <link rel="icon" type="image/png" href="/icon/favicon-96x96.png" sizes="96x96">
  <link rel="icon" type="image/png" href="/icon/favicon-16x16.png" sizes="16x16">
  <link rel="icon" type="image/png" href="/icon/favicon-32x32.png" sizes="32x32">
  <meta name="msapplication-TileColor" content="#2f83cd">
  <meta name="msapplication-TileImage" content="/icon/mstile-144x144.png">
  <meta name="generator" content="Hexo 3.7.0">
  <!-- CSS -->
  <!-- build:css build/css/navy.css -->
  <link rel="stylesheet" href="/css/navy.css">
  <!-- endbuild -->
  <link href="https://fonts.googleapis.com/css?family=Lato:300,400,700" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css">
  <!-- RSS -->
  <link rel="alternate" href="/atom.xml" title="文档">
  <!-- Open Graph -->
  <meta name="description" content="Creating a module with database tablesIn this tutorial we are going to create a module with its own database table. We will need functions to get and save data in the db and also we will need custom d">
<meta property="og:type" content="website">
<meta property="og:title" content="文档">
<meta property="og:url" content="https://hexo.io/docs/modules_crud.html">
<meta property="og:site_name" content="文档">
<meta property="og:description" content="Creating a module with database tablesIn this tutorial we are going to create a module with its own database table. We will need functions to get and save data in the db and also we will need custom d">
<meta property="og:locale" content="en">
<meta property="og:image" content="https://hexo.io/docs/img/db_table_testimonials.png">
<meta property="og:updated_time" content="2016-04-17T21:48:34.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="文档">
<meta name="twitter:description" content="Creating a module with database tablesIn this tutorial we are going to create a module with its own database table. We will need functions to get and save data in the db and also we will need custom d">
<meta name="twitter:image" content="https://hexo.io/docs/img/db_table_testimonials.png">
<meta name="twitter:site" content="hexojs">
<meta property="fb:admins" content="100000247608790">
  <!-- Google Analytics -->
  
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-48498357-3', 'auto');
  ga('send', 'pageview');
</script>

</head>

<body>
  <div id="container">
    <header id="header" class="wrapper">
  <div id="header-inner" class="inner">
    <h1 id="logo-wrap">
      <a href="/" id="logo">Hexo</a>
    </h1>
    <nav id="main-nav">
      <a href="/docs/" class="main-nav-link">Docs</a><a href="/api/" class="main-nav-link">API</a><a href="/news/" class="main-nav-link">News</a><a href="/plugins/" class="main-nav-link">Plugins</a><a href="/themes/" class="main-nav-link">Themes</a>
      <a href="https://github.com/hexojs/hexo" class="main-nav-link"><i class="fa fa-github-alt"></i></a>
      <div id="search-input-wrap">
        <div id="search-input-icon">
          <i class="fa fa-search"></i>
        </div>
        <input type="search" id="search-input" placeholder="Search...">
      </div>
    </nav>
    <div id="lang-select-wrap">
      <label id="lang-select-label"><i class="fa fa-globe"></i><span>English</span></label>
      <select id="lang-select" data-canonical="docs/modules_crud.html">
        
          <option value="en" selected>English</option>
        
          <option value="zh-tw">正體中文</option>
        
          <option value="zh-cn">简体中文</option>
        
          <option value="ru">Русский</option>
        
          <option value="ko">한국어</option>
        
          <option value="pt-br">Português (Brasil)</option>
        
      </select>
    </div>
    <a id="mobile-nav-toggle">
      <span class="mobile-nav-toggle-bar"></span>
      <span class="mobile-nav-toggle-bar"></span>
      <span class="mobile-nav-toggle-bar"></span>
    </a>
  </div>
</header>

    <div id="content-wrap">
  <div id="content" class="wrapper">
    <div id="content-inner">
      <article class="article-container" itemscope itemtype="http://schema.org/Article">
        <div class="article-inner">
          <div class="article">
            <div class="inner">
              <header class="article-header">
                <h1 class="article-title" itemprop="name"></h1>
                <a href="https://github.com/hexojs/site/edit/master/source/docs/modules_crud.md" class="article-edit-link" title="Improve this doc"><i class="fa fa-pencil"></i></a>
              </header>
              <div class="article-content" itemprop="articleBody">
                <h2 id="Creating-a-module-with-database-tables" class="article-heading"><a href="#Creating-a-module-with-database-tables" class="headerlink" title="Creating a module with database tables"></a>Creating a module with database tables<a class="article-anchor" href="#Creating-a-module-with-database-tables" aria-hidden="true"></a></h2><p>In this tutorial we are going to create a module with its own database table. We will need functions to get and save data in the db and also we will need custom database table. </p>
<p>For the example we are going to make a “testimonials” module to show customer testimonials.</p>
<h3 id="Create-the-basic-files" class="article-heading"><a href="#Create-the-basic-files" class="headerlink" title="Create the basic files"></a>Create the basic files<a class="article-anchor" href="#Create-the-basic-files" aria-hidden="true"></a></h3><p>Create new folder at <code>userfiles/modules/testimonials</code></p>
<p>Every module needs the following files to work</p>
<table>
<thead>
<tr>
<th>Filename</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>config.php</td>
<td>this file the info for your module</td>
</tr>
<tr>
<td>index.php</td>
<td>this file loads the module is dropped or opened from the frontend</td>
</tr>
<tr>
<td>admin.php</td>
<td>when you open the module settings from the admin or from the live edit, this file is loaded</td>
</tr>
<tr>
<td>functions.php</td>
<td>optional file, it is loaded on system start with the website</td>
</tr>
<tr>
<td>testimonials.png</td>
<td>icon for your module (size 32x32)</td>
</tr>
</tbody>
</table>
<h4 id="config-php" class="article-heading"><a href="#config-php" class="headerlink" title="config.php"></a>config.php<a class="article-anchor" href="#config-php" aria-hidden="true"></a></h4><p>Create a file at <code>userfiles/modules/testimonials/config.php</code><br>Use this file to define the name of your module and its version as it will appear in the admin panel</p>
<p>In your config.php you can set the <code>$config[&#39;tables&#39;]</code> array which can contain description of the db tables you want to make. </p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$config = <span class="keyword">array</span>();</span><br><span class="line">$config[<span class="string">'name'</span>] = <span class="string">"Testimonials"</span>;</span><br><span class="line">$config[<span class="string">'author'</span>] = <span class="string">"Microweber"</span>;</span><br><span class="line">$config[<span class="string">'ui'</span>] = <span class="keyword">true</span>; <span class="comment">//if set to true, module will be visible in the toolbar</span></span><br><span class="line">$config[<span class="string">'ui_admin'</span>] = <span class="keyword">true</span>; <span class="comment">//if set to true, module will be visible in the admin panel</span></span><br><span class="line">$config[<span class="string">'categories'</span>] = <span class="string">"content"</span>;</span><br><span class="line">$config[<span class="string">'position'</span>] = <span class="number">99</span>;</span><br><span class="line">$config[<span class="string">'version'</span>] = <span class="number">0.1</span>;</span><br><span class="line"></span><br><span class="line">$config[<span class="string">'tables'</span>] = <span class="keyword">array</span>(</span><br><span class="line">    <span class="string">"testimonials"</span> =&gt; <span class="keyword">array</span>(</span><br><span class="line">        <span class="string">'id'</span> =&gt; <span class="string">"integer"</span>,</span><br><span class="line">        <span class="string">'name'</span> =&gt; <span class="string">"text"</span>,</span><br><span class="line">        <span class="string">'content'</span> =&gt; <span class="string">"text"</span>,</span><br><span class="line">        <span class="string">'read_more_url'</span> =&gt; <span class="string">"text"</span>,</span><br><span class="line">        <span class="string">'created_at'</span> =&gt; <span class="string">"dateTime"</span>,</span><br><span class="line">        <span class="string">'position'</span> =&gt; <span class="string">"integer"</span></span><br><span class="line">    )</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<p>On install of the module Microweber will make those tables in the database for you. If you open the database you will see the following SQL table created. If you need control of the database fields type, read more <a href="http://laravel.com/docs/5.0/schema" target="_blank" rel="noopener">here</a>.  </p>
<p><img src="img/db_table_testimonials.png" alt="db_table"></p>
<h4 id="admin-php" class="article-heading"><a href="#admin-php" class="headerlink" title="admin.php"></a>admin.php<a class="article-anchor" href="#admin-php" aria-hidden="true"></a></h4><p>This file loads when you drop the module and click on “settings”. Use the <a href="../functions/only_admin_access.md">only_admin_access</a> function to make the admin files accessible only for admin users.</p>
<p>Put this code in <code>userfiles/modules/testimonials/admin.php</code><br><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span> only_admin_access(); <span class="meta">?&gt;</span></span></span><br><span class="line"><span class="tag">&lt;<span class="name">h2</span>&gt;</span>This is my settings file<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<h4 id="index-php" class="article-heading"><a href="#index-php" class="headerlink" title="index.php"></a>index.php<a class="article-anchor" href="#index-php" aria-hidden="true"></a></h4><p>This file loads when you drop the module or include the module in your code.<br>Put this in <code>userfiles/modules/testimonials/index.php</code> and also create your css and js files and load them.</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"&lt;?php print $config['url_to_module']; ?&gt;testimonials.css"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"&lt;?php print $config['url_to_module']; ?&gt;testimonials.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"testimonials-wrapper"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span>This is my testimonials module<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>###Loading your module</p>
<p>You can load your module in the code or insert it from the live edit, also open it from the admin panel.</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">&lt;module type=<span class="string">"testimonials"</span> /&gt;</span><br></pre></td></tr></table></figure>
<h2 id="Lets-get-busy" class="article-heading"><a href="#Lets-get-busy" class="headerlink" title="Lets get busy"></a>Lets get busy<a class="article-anchor" href="#Lets-get-busy" aria-hidden="true"></a></h2><p>Time to start writing some code.</p>
<p>Now that we have done the basics, we are going to start making our module do stuff and add an interface.</p>
<p>Before we make the interface we must make our functions to save and get data.<br>We are also going to expose few of our functions to the api, which will allow us to make ajax calls to it.</p>
<h4 id="functions-php" class="article-heading"><a href="#functions-php" class="headerlink" title="functions.php"></a>functions.php<a class="article-anchor" href="#functions-php" aria-hidden="true"></a></h4><p>We are going to need few functions to get and save data in the database, so we will put them in this file.</p>
<p>Open <code>userfiles/modules/testimonials/functions.php</code> and add this code.<br><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">api_expose(<span class="string">'save_testimonial'</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">save_testimonial</span><span class="params">($data)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!is_admin()) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    $table = <span class="string">"testimonials"</span>;</span><br><span class="line">    <span class="keyword">return</span> db_save($table, $data);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">get_testimonials</span><span class="params">($params=array<span class="params">()</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (is_string($params)) &#123;</span><br><span class="line">        $params = parse_params($params);</span><br><span class="line">    &#125;</span><br><span class="line">    $params[<span class="string">'table'</span>] = <span class="string">"testimonials"</span>;</span><br><span class="line">    <span class="keyword">return</span> db_get($params);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">api_expose(<span class="string">'delete_testimonial'</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">delete_testimonial</span><span class="params">($params)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!is_admin()) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">isset</span>($params[<span class="string">'id'</span>])) &#123;</span><br><span class="line">        $table = <span class="string">"testimonials"</span>;</span><br><span class="line">        $id = $params[<span class="string">'id'</span>];</span><br><span class="line">        <span class="keyword">return</span> db_delete($table, $id);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>Note the <a href="../functions/api_expose.md">api_expose</a> usage before the “save_testimonial” function, this allows us to call this function from <a href="http://example.com/api/save_testimonial" target="_blank" rel="noopener">http://example.com/api/save_testimonial</a> .</p>
<p>As you can see those functions are just a references to the <a href="../functions/db_get.md" title="db_get">db_get</a>, <a href="../functions/db_save.md" title="db_save">db_save</a> and <a href="../functions/db_delete.md" title="delete_by_id">db_delete</a>.</p>
<h4 id="admin-php-1" class="article-heading"><a href="#admin-php-1" class="headerlink" title="admin.php"></a>admin.php<a class="article-anchor" href="#admin-php-1" aria-hidden="true"></a></h4><p>As we have our functions ready its time for the fun part, to add the interface.</p>
<p>In order to make our module dynamic and able to reload different parts of it we will split it on several sub-modules.</p>
<p>Open <code>userfiles/modules/testimonials/admin.php</code> and add the following code to load the modules needed for adding and listing the information</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span> only_admin_access(); <span class="meta">?&gt;</span></span></span><br><span class="line"><span class="tag">&lt;<span class="name">module</span> <span class="attr">type</span>=<span class="string">"testimonials/edit"</span> <span class="attr">id</span>=<span class="string">"edit-testimonials"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">module</span> <span class="attr">type</span>=<span class="string">"testimonials/list"</span> <span class="attr">id</span>=<span class="string">"list-testimonials"</span> /&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="edit-php" class="article-heading"><a href="#edit-php" class="headerlink" title="edit.php"></a>edit.php<a class="article-anchor" href="#edit-php" aria-hidden="true"></a></h4><p>Now you need to create <code>userfiles/modules/testimonials/edit.php</code> file which we will use to post via ajax.<br><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span> only_admin_access(); <span class="meta">?&gt;</span></span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">    $(<span class="built_in">document</span>).ready(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">        $(<span class="string">"#add-testimonial-form"</span>).submit(<span class="function"><span class="keyword">function</span> (<span class="params">event</span>) </span>&#123;</span></span><br><span class="line"><span class="undefined">            event.preventDefault();</span></span><br><span class="line"><span class="javascript">            <span class="keyword">var</span> data = $(<span class="keyword">this</span>).serialize();</span></span><br><span class="line"><span class="xml">            var url = "<span class="php"><span class="meta">&lt;?php</span> <span class="keyword">print</span> api_url(<span class="string">'save_testimonial'</span>); <span class="meta">?&gt;</span></span>";</span></span><br><span class="line"><span class="javascript">            <span class="keyword">var</span> post = $.post(url, data);</span></span><br><span class="line"><span class="javascript">            post.done(<span class="function"><span class="keyword">function</span> (<span class="params">data</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">                mw.reload_module(<span class="string">"testimonials"</span>);</span></span><br><span class="line"><span class="javascript">                mw.reload_module(<span class="string">"testimonials/list"</span>);</span></span><br><span class="line"><span class="undefined">            &#125;);</span></span><br><span class="line"><span class="undefined">        &#125;);</span></span><br><span class="line"><span class="undefined">    &#125;);</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">id</span>=<span class="string">"add-testimonial-form"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h3</span>&gt;</span>Add new testimonial<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"mw-ui-label"</span>&gt;</span>Name<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"name"</span> <span class="attr">class</span>=<span class="string">"mw-ui-field"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"mw-ui-label"</span>&gt;</span>Content<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">textarea</span>  <span class="attr">name</span>=<span class="string">"content"</span> <span class="attr">class</span>=<span class="string">"mw-ui-field"</span>&gt;</span><span class="tag">&lt;/<span class="name">textarea</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">name</span>=<span class="string">"submit"</span> <span class="attr">value</span>=<span class="string">"Save"</span> <span class="attr">class</span>=<span class="string">"mw-ui-btn"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>This module loads when you put <code>&lt;module type=&quot;testimonials/edit&quot; /&gt;</code> in your code, as we did in admin.php </p>
<p>Now its time to list our testimonials. </p>
<h4 id="list-php" class="article-heading"><a href="#list-php" class="headerlink" title="list.php"></a>list.php<a class="article-anchor" href="#list-php" aria-hidden="true"></a></h4><p>Open <code>userfiles/modules/testimonials/list.php</code> and add this code.  </p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span> only_admin_access(); <span class="meta">?&gt;</span></span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="function"><span class="keyword">function</span> <span class="title">delete_testimonial</span>(<span class="params">id</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> are_you_sure = confirm(<span class="string">"Are you sure?"</span>);</span></span><br><span class="line"><span class="javascript">        <span class="keyword">if</span> (are_you_sure == <span class="literal">true</span>) &#123;</span></span><br><span class="line"><span class="javascript">            <span class="keyword">var</span> data = &#123;&#125;</span></span><br><span class="line"><span class="undefined">            data.id = id;</span></span><br><span class="line"><span class="xml">            var url = "<span class="php"><span class="meta">&lt;?php</span> <span class="keyword">print</span> api_url(<span class="string">'delete_testimonial'</span>); <span class="meta">?&gt;</span></span>";</span></span><br><span class="line"><span class="javascript">            <span class="keyword">var</span> post = $.post(url, data);</span></span><br><span class="line"><span class="javascript">            post.done(<span class="function"><span class="keyword">function</span> (<span class="params">data</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">                mw.reload_module(<span class="string">"testimonials"</span>);</span></span><br><span class="line"><span class="javascript">                mw.reload_module(<span class="string">"testimonials/list"</span>);</span></span><br><span class="line"><span class="undefined">            &#125;);</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="php"><span class="meta">&lt;?php</span> $data = get_testimonials(<span class="string">"no_limit=true"</span>); <span class="meta">?&gt;</span></span></span><br><span class="line"><span class="php"><span class="meta">&lt;?php</span> <span class="keyword">if</span> ($data): <span class="meta">?&gt;</span></span></span><br><span class="line">    <span class="tag">&lt;<span class="name">table</span> <span class="attr">width</span>=<span class="string">"100%"</span> <span class="attr">class</span>=<span class="string">"mw-ui-table"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">thead</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">th</span>&gt;</span>Name<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">th</span>&gt;</span>Content<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">th</span>&gt;</span><span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">thead</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tbody</span>&gt;</span></span><br><span class="line">        <span class="php"><span class="meta">&lt;?php</span> <span class="keyword">foreach</span> ($data <span class="keyword">as</span> $item): <span class="meta">?&gt;</span></span></span><br><span class="line">            <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="php"><span class="meta">&lt;?php</span> <span class="keyword">print</span> $item[<span class="string">'name'</span>] <span class="meta">?&gt;</span></span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="php"><span class="meta">&lt;?php</span> <span class="keyword">print</span> $item[<span class="string">'content'</span>] <span class="meta">?&gt;</span></span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"mw-ui-btn"</span></span></span><br><span class="line"><span class="tag">                       <span class="attr">href</span>=<span class="string">"javascript:delete_testimonial('&lt;?php print $item['id'] ?&gt;');"</span>&gt;</span>Delete</span><br><span class="line">                    <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="php"><span class="meta">&lt;?php</span> <span class="keyword">endforeach</span>; <span class="meta">?&gt;</span></span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">tbody</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line"><span class="php"><span class="meta">&lt;?php</span> <span class="keyword">endif</span>; <span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure>
<p>Now we have the admin part working. Its time to display the testimonials on our site. </p>
<h4 id="index-php-1" class="article-heading"><a href="#index-php-1" class="headerlink" title="index.php"></a>index.php<a class="article-anchor" href="#index-php-1" aria-hidden="true"></a></h4><p>Open <code>userfiles/modules/testimonials/index.php</code> and add this code.  </p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"&lt;?php print $config['url_to_module']; ?&gt;testimonials.css"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"&lt;?php print $config['url_to_module']; ?&gt;testimonials.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="php"><span class="meta">&lt;?php</span> $data = get_testimonials(<span class="string">"no_limit=true"</span>); <span class="meta">?&gt;</span></span></span><br><span class="line"><span class="php"><span class="meta">&lt;?php</span> <span class="keyword">if</span> ($data): <span class="meta">?&gt;</span></span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"rotator_&lt;?php print $params['id'] ?&gt;"</span> <span class="attr">class</span>=<span class="string">"testimonials-wrapper"</span>&gt;</span></span><br><span class="line">        <span class="php"><span class="meta">&lt;?php</span> <span class="keyword">foreach</span> ($data <span class="keyword">as</span> $item): <span class="meta">?&gt;</span></span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"rotating-item"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">h3</span> <span class="attr">class</span>=<span class="string">"testimonial-name"</span>&gt;</span><span class="php"><span class="meta">&lt;?php</span> <span class="keyword">print</span> $item[<span class="string">'name'</span>] <span class="meta">?&gt;</span></span><span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"testimonial-content"</span>&gt;</span><span class="php"><span class="meta">&lt;?php</span> <span class="keyword">print</span> $item[<span class="string">'content'</span>] <span class="meta">?&gt;</span></span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="php"><span class="meta">&lt;?php</span> <span class="keyword">endforeach</span>; <span class="meta">?&gt;</span></span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="php"><span class="meta">&lt;?php</span> <span class="keyword">endif</span>; <span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure>
<p>When you drop the module in the live edit or type <code>&lt;module type=&quot;testimonials&quot; /&gt;</code>, the <code>index.php</code> file serves as the “front-end” of the module. </p>
<h3 id="That’s-it" class="article-heading"><a href="#That’s-it" class="headerlink" title="That’s it!"></a>That’s it!<a class="article-anchor" href="#That’s-it" aria-hidden="true"></a></h3><p>We are ready to go. </p>

              </div>
              <footer class="article-footer">
                <time class="article-footer-updated" datetime="2016-04-17T21:48:34.000Z" itemprop="dateModified">Last updated: 2016-04-17</time>
                <a href="index.html" class="article-footer-next" title="Overview"><span>Next</span><i class="fa fa-chevron-right"></i></a>
              </footer>
              
<section id="comments">
  <div id="disqus_thread"></div>
</section>
<script>
  var disqus_shortname = 'hexojs';
  var disqus_url = 'https://hexo.io/docs/modules_crud.html';
  var disqus_title = "";
  var disqus_config = function(){
    this.language = 'en';
  };
  (function(){
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = 'https://go.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>

            </div>
          </div>
          <aside id="article-toc" role="navigation">
            <div id="article-toc-inner">
              <script async type="text/javascript" src="//cdn.carbonads.com/carbon.js?zoneid=1673&serve=C6AILKT&placement=hexoio" id="_carbonads_js"></script>
              <strong class="sidebar-title">Contents</strong>
              <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Creating-a-module-with-database-tables"><span class="toc-text">Creating a module with database tables</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Create-the-basic-files"><span class="toc-text">Create the basic files</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#config-php"><span class="toc-text">config.php</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#admin-php"><span class="toc-text">admin.php</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#index-php"><span class="toc-text">index.php</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Lets-get-busy"><span class="toc-text">Lets get busy</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#functions-php"><span class="toc-text">functions.php</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#admin-php-1"><span class="toc-text">admin.php</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#edit-php"><span class="toc-text">edit.php</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#list-php"><span class="toc-text">list.php</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#index-php-1"><span class="toc-text">index.php</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#That’s-it"><span class="toc-text">That’s it!</span></a></li></ol></li></ol>
              <a href="#" id="article-toc-top">Back to Top</a>
            </div>
          </aside>
        </div>
      </article>
      <aside id="sidebar" role="navigation">
  <div class="inner">
    <strong class="sidebar-title">Getting Started</strong><a href="index.html" class="sidebar-link">Overview</a><a href="setup.html" class="sidebar-link">Setup</a><a href="configuration.html" class="sidebar-link">Configuration</a><a href="commands.html" class="sidebar-link">Commands</a><a href="migration.html" class="sidebar-link">Migration</a><strong class="sidebar-title">Basic Usage</strong><a href="writing.html" class="sidebar-link">Writing</a><a href="front-matter.html" class="sidebar-link">Front-matter</a><a href="tag-plugins.html" class="sidebar-link">Tag Plugins</a><a href="asset-folders.html" class="sidebar-link">Asset Folders</a><a href="data-files.html" class="sidebar-link">Data Files</a><a href="server.html" class="sidebar-link">Server</a><a href="generating.html" class="sidebar-link">Generating</a><a href="deployment.html" class="sidebar-link">Deployment</a><strong class="sidebar-title">Customization</strong><a href="permalinks.html" class="sidebar-link">Permalinks</a><a href="themes.html" class="sidebar-link">Themes</a><a href="templates.html" class="sidebar-link">Templates</a><a href="variables.html" class="sidebar-link">Variables</a><a href="helpers.html" class="sidebar-link">Helpers</a><a href="internationalization.html" class="sidebar-link">Internationalization (i18n)</a><a href="plugins.html" class="sidebar-link">Plugins</a><strong class="sidebar-title">Miscellaneous</strong><a href="troubleshooting.html" class="sidebar-link">Troubleshooting</a><a href="contributing.html" class="sidebar-link">Contributing</a>
  </div>
</aside>
    </div>
  </div>
</div>

    <footer id="footer" class="wrapper">
  <div class="inner">
    <div id="footer-copyright">
      &copy; 2018 <a href="https://github.com/hexojs/hexo/graphs/contributors" target="_blank">Hexo</a><br>
      Documentation licensed under <a href="http://creativecommons.org/licenses/by/4.0/" target="_blank">CC BY 4.0</a>.
    </div>
    <div id="footer-links">
      <a href="https://twitter.com/hexojs" class="footer-link" target="_blank"><i class="fa fa-twitter"></i></a>
      <a href="https://github.com/hexojs/hexo" class="footer-link" target="_blank"><i class="fa fa-github-alt"></i></a>
    </div>
  </div>
</footer>

  </div>
  <div id="mobile-nav-dimmer"></div>
  <nav id="mobile-nav">
  <div id="mobile-nav-inner">
    <ul id="mobile-nav-list">
      <a href="/docs/" class="mobile-nav-link">Docs</a><a href="/api/" class="mobile-nav-link">API</a><a href="/news/" class="mobile-nav-link">News</a><a href="/plugins/" class="mobile-nav-link">Plugins</a><a href="/themes/" class="mobile-nav-link">Themes</a>
      <li class="mobile-nav-item">
        <a href="https://github.com/hexojs/hexo" class="mobile-nav-link" rel="external" target="_blank">GitHub</a>
      </li>
    </ul>
    
      <strong class="mobile-nav-title">Getting Started</strong><a href="index.html" class="mobile-nav-link">Overview</a><a href="setup.html" class="mobile-nav-link">Setup</a><a href="configuration.html" class="mobile-nav-link">Configuration</a><a href="commands.html" class="mobile-nav-link">Commands</a><a href="migration.html" class="mobile-nav-link">Migration</a><strong class="mobile-nav-title">Basic Usage</strong><a href="writing.html" class="mobile-nav-link">Writing</a><a href="front-matter.html" class="mobile-nav-link">Front-matter</a><a href="tag-plugins.html" class="mobile-nav-link">Tag Plugins</a><a href="asset-folders.html" class="mobile-nav-link">Asset Folders</a><a href="data-files.html" class="mobile-nav-link">Data Files</a><a href="server.html" class="mobile-nav-link">Server</a><a href="generating.html" class="mobile-nav-link">Generating</a><a href="deployment.html" class="mobile-nav-link">Deployment</a><strong class="mobile-nav-title">Customization</strong><a href="permalinks.html" class="mobile-nav-link">Permalinks</a><a href="themes.html" class="mobile-nav-link">Themes</a><a href="templates.html" class="mobile-nav-link">Templates</a><a href="variables.html" class="mobile-nav-link">Variables</a><a href="helpers.html" class="mobile-nav-link">Helpers</a><a href="internationalization.html" class="mobile-nav-link">Internationalization (i18n)</a><a href="plugins.html" class="mobile-nav-link">Plugins</a><strong class="mobile-nav-title">Miscellaneous</strong><a href="troubleshooting.html" class="mobile-nav-link">Troubleshooting</a><a href="contributing.html" class="mobile-nav-link">Contributing</a>
    
  </div>
  <div id="mobile-lang-select-wrap">
    <span id="mobile-lang-select-label"><i class="fa fa-globe"></i><span>English</span></span>
    <select id="mobile-lang-select" data-canonical="docs/modules_crud.html">
      
        <option value="en" selected>English</option>
      
        <option value="zh-tw">正體中文</option>
      
        <option value="zh-cn">简体中文</option>
      
        <option value="ru">Русский</option>
      
        <option value="ko">한국어</option>
      
        <option value="pt-br">Português (Brasil)</option>
      
    </select>
  </div>
</nav>
  <!-- Scripts -->
<!-- build:js build/js/main.js -->
<script src="/js/lang_select.js"></script>
<script src="/js/toc.js"></script>
<script src="/js/mobile_nav.js"></script>
<!-- endbuild -->

<!-- Algolia -->

<script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script>
<script type="text/javascript">
document.getElementById('search-input-wrap').classList.add('on');
docsearch({
  apiKey: 'c3d5d4c995b5e0c2ffb5623900279a66',
  indexName: 'hexo',
  inputSelector: '#search-input'
});
</script>


</body>
</html>